<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="com.ibm.streamsx.mongodb::Query"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_operator__com.ibm.streamsx.mongodb__Query"/>
<link rel="stylesheet" type="text/css" href="../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../html/spldoc.css"/>
<title>com.ibm.streamsx.mongodb::Query</title>
</head>
<body id="spldoc_operator__com.ibm.streamsx.mongodb__Query">


<h1 class="title topictitle1">com.ibm.streamsx.mongodb::Query</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="toolkit.html">
com.ibm.streamsx.mongodb
</a>
-&gt; <a class="xref" href="com.ibm.streamsx.mongodb$.html">com.ibm.streamsx.mongodb</a>-&gt; Query</p>

</div>

<div class="section">

<p class="p">Query reads SPL data from MongoDB collection. No predefined db schema is required, the data is automatically mapped from BSON to SPL. The operator uses db connection pool and supports multiple threads. 
</p>

<p class="p">Query has three custom output functions: 
</p>

<ul class="ul">
<li class="li"> QueryDocumentField reads data from a fieldName as the output attribute name, with or without a specified search field tag. </li>

<li class="li"> QueryDocumentMultipleFields reads data under a fieldName as the output attribute name, with or without a specified search field tag.. </li>

<li class="li"> QueryDocumentFieldAsJson reads the whole data as JSON string. </li>

</ul>

<p class="p"> Single input port is allowed. 
</p>

<div class="p">One output port is defined for use with custom output functions, multiple tuples maybe submitted per one query. 
<pre class="pre codeblock">
  
</pre>


</div>

</div>

<div class="section splprimop">
<object type="image/svg+xml" data="../image/com.ibm.streamsx.mongodb$Query.svg" width="672" height="112">
<span>Primitive operator image not displayed. Problem loading file: ../image/com.ibm.streamsx.mongodb$Query.svg
</span>
</object>
</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Summary</h2>

<dl class="dl" compact="compact">
 
  <dt class="dt dlterm">Ports</dt>

  <dd class="dd">This operator has 1 input port and 1 output port.</dd>

 
 
  <dt class="dt dlterm">Windowing</dt>

  <dd class="dd">This operator does not accept any windowing configurations.</dd>

 
 
  <dt class="dt dlterm">Parameters</dt>

  <dd class="dd">This operator supports 8 parameters.
<p class="p"> Required: 
<a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__collection">collection</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbName">dbName</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbHost">dbHost</a>

</p>

<p class="p"> Optional: 
<a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbPort">dbPort</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__findFields">findFields</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__findQuery">findQuery</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__nToReturn">nToReturn</a>, <a class="xref" href="#spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__timeout">timeout</a>

</p>
</dd>

 
 
  <dt class="dt dlterm">Metrics</dt>

  <dd class="dd">This operator reports  1 metrics.</dd>

 
</dl>
</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Properties</h2>

<dl class="dl" compact="compact">
 
  <dt class="dt dlterm">Implementation</dt>

  <dd class="dd">C++</dd>

 
 
  <dt class="dt dlterm"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__providessinglethreadedexecutioncontext">Threading</a></dt>

  <dd class="dd"><tt class="ph tt">Always</tt> - Operator always provides a single threaded execution context.</dd>

 
</dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set">Input Ports</a></strong></p>
<dl class="dl">
  
   <dt class="dt dlterm">Ports (0)</dt>

   <dd class="dd">
<p class="p">The Query operator is configurable with a single input port. The input port is non-mutating and its punctuation mode is Oblivious.
</p>

   <dl class="dl">
    
      <dt class="dt dlterm">Windowing</dt>

      <dd class="dd">
      </dd>

    
    
      <dt class="dt dlterm">Properties</dt>

      <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set__optional">Optional</a>: false
     </li>

   </ul>

   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set__controlport">ControlPort</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set__tuplemutationallowed">TupleMutationAllowed</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set__windowingmode">WindowingMode</a>: NonWindowed
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__input_port_set__windowpunctuationinputmode">WindowPunctuationInputMode</a>: Oblivious
     </li>

   </ul>

      </dd>
    
   </dl>

   <p class="p"/>
   </dd>

  
</dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__output_port_set">Output Ports</a></strong></p>
<dl class="dl">
  
     <dt class="dt dlterm">Assignments</dt>

     <dd class="dd">This operator allows any SPL expression of the correct type to be assigned to output attributes. Attributes not assigned in the output clause will be automatically assigned from the attributes of the input ports that have the same name and type. If there is no such input attribute, an error is reported at compile-time.</dd>

  
</dl>

<dl class="dl">
  <dt class="dt dlterm"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__customoutputfunctions">Output Functions</a></dt>

   <dd class="dd">
      <dl class="dl">
     
        <dt class="dt dlterm">MongoFS</dt>

        <dd class="dd">
          <p class="p">
            <tt class="ph tt">   &lt;any T&gt; T AsIs(T v)</tt> -         </p>

          <p class="p">
            <tt class="ph tt">   &lt;string T&gt; T QueryDocumentFieldAsJson()</tt> - 
Reads document from 'db.coolection' as a JSON string. T can be of type rstring or ustring only.
        </p>

          <p class="p">
            <tt class="ph tt">   &lt;any T&gt; T QueryDocumentField()</tt> - 
Reads document from 'db.coolection'. Searched for output assignment attribute name.
        </p>

          <p class="p">
            <tt class="ph tt">   &lt;any T&gt; T QueryDocumentField(rstring findPath)</tt> - 
Reads document from 'db.coolection'. Searched for output assignment attribute name, then for a findPath name.
        </p>

          <p class="p">
            <tt class="ph tt">   &lt;any T&gt; T QueryDocumentMultipleFields()</tt> - 
Reads multiple documents from 'db.coolection'. Searched for all documents under output assignment attribute name.
        </p>

          <p class="p">
            <tt class="ph tt">   &lt;any T&gt; T QueryDocumentMultipleFields(rstring findPath)</tt> - 
Reads multiple documents from 'db.coolection'. Searched for all documents under output assignment attribute name, then for a findPath name.
        </p>

        </dd>

    
      </dl>

   </dd>

 </dl>

 <dl class="dl">
  
   <dt class="dt dlterm">Ports (0)</dt>

   <dd class="dd">

<p class="p">The Query operator is configurable with one output port. The output port is non-mutating and their punctuation mode is Generating.
</p>

    <p class="p"/>

    <dl class="dl">
     
      <dt class="dt dlterm">Properties</dt>

      <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__output_port_set__optional">Optional</a>: false
     </li>

   </ul>

   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__output_port_set__tuplemutationallowed">TupleMutationAllowed</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__output_port_set__windowpunctuationoutputmode">WindowPunctuationOutputMode</a>: Generating
     </li>

   </ul>

</dd>
     
    </dl>

    <p class="p"/>

   </dd>

  
</dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters">Parameters</a></strong></p>

<dl class="dl">
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__collection"><!-- --></a><tt class="ph tt">collection</tt></dt>

     <dd class="dd">
<p class="p">The mandatory 'rstring' parameter specifies MongoDB collection.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: rstring
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: AttributeFree
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbName"><!-- --></a><tt class="ph tt">dbName</tt></dt>

     <dd class="dd">
<p class="p">The mandatory 'rstring' parameter specifies MongoDB database.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: rstring
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: AttributeFree
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbHost"><!-- --></a><tt class="ph tt">dbHost</tt></dt>

     <dd class="dd">
<p class="p">The mandatory 'rstring' parameter specifies MongoDB server host.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: rstring
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: false
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: AttributeFree
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__dbPort"><!-- --></a><tt class="ph tt">dbPort</tt></dt>

     <dd class="dd">
<p class="p">The optional 'uint32' parameter specifies MongoDB server listener port. Default value is 27017.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: uint32
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: true
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: AttributeFree
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__findFields"><!-- --></a><tt class="ph tt">findFields</tt></dt>

     <dd class="dd">
<p class="p">The optional 'map&lt;rstring,int32&gt;' parameter specifies which fields to include or drop from the result.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: map&lt;rstring,int32&gt;
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: true
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: Expression
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__findQuery"><!-- --></a><tt class="ph tt">findQuery</tt></dt>

     <dd class="dd">
<p class="p">The optional map or tuple parameter specifies a <a class="xref" href="http://docs.mongodb.org/manual/reference/operator/query">query</a> to get specific data from MongoDB collection.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: 
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: true
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: Expression
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__nToReturn"><!-- --></a><tt class="ph tt">nToReturn</tt></dt>

     <dd class="dd">
<p class="p">The optional 'uint32' parameter specifies max number of documents to fetch.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: uint32
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: true
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: Expression
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
  
     <dt class="dt dlterm"><a name="spldoc_operator__com.ibm.streamsx.mongodb__Query__parameter__timeout"><!-- --></a><tt class="ph tt">timeout</tt></dt>

     <dd class="dd">
<p class="p">The optional 'float64' parameter specifies connection timeout. Default value is 0.
</p>

  <dl class="dl">
    
     <dt class="dt dlterm">Properties</dt>

     <dd class="dd">   <ul class="sl simple">
     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__type">Type</a>: float64
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__cardinality">Cardinality</a>: 1
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__optional">Optional</a>: true
     </li>

     <li class="sli"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__parameters__parameter__expressionmode">ExpressionMode</a>: AttributeFree
     </li>

   </ul>

     <p class="p"/>
     </dd>

    
  </dl>

     </dd>

  
</dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__codetemplate">Code Templates</a></strong></p>
  <dl class="dl">
    
     <dt class="dt dlterm">Query</dt>

     <dd class="dd">
       <pre class="pre codeblock">
stream&lt;${schema}&gt; ${outputStream} = Query(${inputStream}) {
	param
		dbHost : "";
		dbName : "";
		collection : "";
	output ${outputStream} :
		attr = QueryDocumentField();
}
      </pre>

     <p class="p"/>

     </dd>

    
  </dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__metrics">Metrics</a></strong></p>
<dl class="dl">
  
    <dt class="dt dlterm"><tt class="ph tt">dbConnectionPoolSize</tt> - <a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__metrics_kind_gauge">Gauge</a></dt>

    <dd class="dd">

     <p class="p"/>

     </dd>

  
</dl>

</div>

<div class="section">
<p class="p splhead-1"><strong class="ph b"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__dependencies">Libraries</a></strong></p>
<dl class="dl">
 
  <dt class="dt dlterm">No description for library
  </dt>

<dd class="dd"/>
  <dd class="dd"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__dependencies__managedlibrary__command">Command</a>: ../../impl/bin/setLinks.sh
  </dd>

  <dd class="dd"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__dependencies__managedlibrary__lib">Library Name</a>: <tt class="ph tt">mongoclient</tt></dd>

  <dd class="dd"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__dependencies__managedlibrary__libpath">Library Path</a>: <tt class="ph tt">../../impl/lib</tt></dd>

  <dd class="dd"><a class="xref" href="OperatorModel.html#spldoc_reference_operator_model__context__dependencies__managedlibrary__includepath">Include Path</a>: <tt class="ph tt">../../impl/include</tt></dd>

 
</dl>

</div>

</div>


</body>
</html>